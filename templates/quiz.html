<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Armenian Alphabet Quiz</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <script>
        async function fetchQuestion() {
            const category = document.querySelector('input[name="category"]:checked').value;
            const response = await fetch('/get_question', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: `category=${category}`
            });
            const data = await response.json();
            displayQuestion(data);
        }

        function displayQuestion(data) {
            const questionElement = document.getElementById('question');
            const choicesElement = document.getElementById('choices');
            const feedbackElement = document.getElementById('feedback');
            choicesElement.innerHTML = '';
            feedbackElement.textContent = ''; // Clear feedback

            if (data.question.endsWith('.ogg')) {
                questionElement.innerHTML = `<audio controls src="${data.question}"></audio>`;
            } else {
                questionElement.textContent = data.question;
            }

            data.choices.forEach(choice => {
                const button = document.createElement('button');
                button.textContent = choice;
                button.className = "btn btn-primary btn-block";
                button.onclick = () => checkAnswer(choice, data.correct);
                choicesElement.appendChild(button);
            });
        }

        function checkAnswer(choice, correct) {
            const feedbackElement = document.getElementById('feedback');
            if (choice === correct) {
                feedbackElement.textContent = 'Correct!';
                feedbackElement.className = 'text-success';
            } else {
                feedbackElement.textContent = `Incorrect. The correct answer was: ${correct}`;
                feedbackElement.className = 'text-danger';
            }

            setTimeout(fetchQuestion, 1500); // Fetch new question after 1.5 seconds
        }
    </script>
</head>
<body onload="fetchQuestion()">
    <div class="container">
        <h1>Armenian Alphabet Quiz</h1>
        <form class="mb-4">
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="category" id="uppercase" value="uppercase" checked>
                <label class="form-check-label" for="uppercase">Uppercase</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="category" id="lowercase" value="lowercase">
                <label class="form-check-label" for="lowercase">Lowercase</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="category" id="transcription" value="transcription">
                <label class="form-check-label" for="transcription">Transcription</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="category" id="pronunciation" value="pronunciation">
                <label class="form-check-label" for="pronunciation">Pronunciation</label>
            </div>
        </form>
        <div id="question" class="mb-4"></div>
        <div id="choices"></div>
        <div id="feedback" class="mt-4"></div>
    </div>
</body>
</html>
