<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Armenian Alphabet Quiz</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <script>
        async function fetchQuestion() {
            const questionCategory = getSelectedCategory('questionCategory');
            const answerCategory = getSelectedCategory('answerCategory');
            const response = await fetch('/get_question', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: `category=${questionCategory}&answer_category=${answerCategory}`
            });
            const data = await response.json();
            displayQuestion(data);
        }

        function getSelectedCategory(categoryName) {
            const selectedValue = document.querySelector(`input[name="${categoryName}"]:checked`).value;
            if (selectedValue === 'random') {
                const categories = ['uppercase', 'lowercase', 'transcription', 'pronunciation', 'handwritten'];
                return categories[Math.floor(Math.random() * categories.length)];
            }
            return selectedValue;
        }

        function displayQuestion(data) {
            const questionElement = document.getElementById('question');
            const choicesElement = document.getElementById('choices');
            const feedbackElement = document.getElementById('feedback');
            choicesElement.innerHTML = '';
            feedbackElement.textContent = ''; // Clear feedback

            if (data.question.endsWith('.ogg')) {
                questionElement.innerHTML = `<audio controls src="${data.question}"></audio>`;
            } else if (data.question.endsWith('.svg')) {
                questionElement.innerHTML = `<img src="${data.question}" class="img-fluid" alt="Handwritten Letter">`;
            } else {
                questionElement.textContent = data.question;
            }

            data.choices.forEach(choice => {
                const button = document.createElement('button');
                button.innerHTML = choice.endsWith('.svg') ? `<img src="${choice}" class="img-fluid" alt="Handwritten Letter">` : choice;
                button.className = "btn btn-primary btn-block";
                button.onclick = () => checkAnswer(choice, data.correct);
                choicesElement.appendChild(button);
            });
        }

        function checkAnswer(choice, correct) {
            const feedbackElement = document.getElementById('feedback');
            if (choice === correct) {
                feedbackElement.textContent = 'Correct!';
                feedbackElement.className = 'text-success';
            } else {
                feedbackElement.textContent = `Incorrect. The correct answer was: ${correct}`;
                feedbackElement.className = 'text-danger';
            }

            setTimeout(fetchQuestion, 1500); // Fetch new question after 1.5 seconds
        }
    </script>
</head>
<body onload="fetchQuestion()">
    <div class="container">
        <h1>Armenian Alphabet Quiz</h1>

        <!-- Question Category Selection -->
        <form class="mb-4">
            <h5>Select Question Category:</h5>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="questionCategory" id="uppercase" value="uppercase" checked>
                <label class="form-check-label" for="uppercase">Uppercase</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="questionCategory" id="lowercase" value="lowercase">
                <label class="form-check-label" for="lowercase">Lowercase</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="questionCategory" id="transcription" value="transcription">
                <label class="form-check-label" for="transcription">Transcription</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="questionCategory" id="pronunciation" value="pronunciation">
                <label class="form-check-label" for="pronunciation">Pronunciation</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="questionCategory" id="handwritten" value="handwritten">
                <label class="form-check-label" for="handwritten">Handwritten</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="questionCategory" id="randomQuestion" value="random">
                <label class="form-check-label" for="randomQuestion">Random</label>
            </div>
        </form>

        <!-- Answer Category Selection -->
        <form class="mb-4">
            <h5>Select Answer Category:</h5>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="answerCategory" id="uppercaseAnswer" value="uppercase" checked>
                <label class="form-check-label" for="uppercaseAnswer">Uppercase</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="answerCategory" id="lowercaseAnswer" value="lowercase">
                <label class="form-check-label" for="lowercaseAnswer">Lowercase</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="answerCategory" id="transcriptionAnswer" value="transcription">
                <label class="form-check-label" for="transcriptionAnswer">Transcription</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="answerCategory" id="pronunciationAnswer" value="pronunciation">
                <label class="form-check-label" for="pronunciationAnswer">Pronunciation</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="answerCategory" id="handwrittenAnswer" value="handwritten">
                <label class="form-check-label" for="handwrittenAnswer">Handwritten</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="answerCategory" id="randomAnswer" value="random">
                <label class="form-check-label" for="randomAnswer">Random</label>
            </div>
        </form>

        <!-- Display Question and Choices -->
        <div id="question" class="mb-4"></div>
        <div id="choices"></div>
        <div id="feedback" class="mt-4"></div>
    </div>
</body>
</html>
